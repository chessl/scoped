<!DOCTYPE html>
<html>
<body>

<header>
  <main id="main">
    <style scoped type="text/css" id="scoped">
      @import './file.css';
/*      @import './does-not-exist.css';
*/

      h1 {
        color: red;
      }
      @media (min-width: 300px) {
        h1 {
          color: green;
        }
      }

      a {
        color: pink;
      }
    </style>
    <h1>I should be red</h1>
    <p>
      <a>What about me?</a>
    </p>
    <p>
      And blue
    </p>
  </main>
  <footer id="footer">
    <h1>I should not be red</h1>
    <p>
      <a>But not me</a>
    </p>
    <p>
      And not blue
    </p>
  </footer>
</header>

<button id="move">Move CSS</button>
<button id="show">Show Rules</button>

<pre id="out"></pre>

<script>
  move.addEventListener('click', (ev) => {
    let target = main;
    if (scoped.parentNode === main) {
      target = footer;
    }
    target.appendChild(scoped);
    out.textContent = '';
  });
  show.addEventListener('click', (ev) => {
    out.textContent = '';
    let content = [];

    const rules = scoped.sheet.cssRules;
    for (let i = 0; i < rules.length; ++i) {
      content.push(rules[i].cssText);
    }

    out.textContent = content.join('\n');
  });
</script>

<script src="../scoped.js"></script>
</body>
</html>